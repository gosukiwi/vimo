" [ FILES ]
" File-related functionality. See also `rcplugins/ctrlp` and
" `rcplugins/filebeagle`.
"
" Key bindings
"
"     <leader><fr>
"       File Rename
"       NORMAL MODE
"
"     <leader><fd>
"       File Delete
"       NORMAL MODE
"

function RenameFile()
  " full path to current file
  let oldPath = expand('%:p')
  let currentFileName = expand('%:t')

  " prompt for new file name
  call inputsave()
  let newName = input("New file name: ")
  call inputrestore()

  if "" == newName
    return
  endif

  let newPath = substitute(oldPath, currentFileName, newName, "")
  echo newPath

  execute "saveas " . newPath
  execute "!rm " . oldPath
endfunction

function DeleteFile()
  let currentFile  = expand('%:p')
  let confirmation = confirm("Are you sure you want to delete this file? [Y/n]")

  if confirmation
    bd
    execute "!rm " . currentFile
  endif
endfunction

nnoremap <leader>fr :call RenameFile()<CR><CR>
nnoremap <leader>fd :call DeleteFile()<CR><CR>

" vim:ft=vim
